--- src/hardware.c	Mon Oct  8 15:40:22 2001
+++ src/hardware.c	Thu Nov  1 18:46:12 2001
@@ -181,7 +173,7 @@
             mc6846_WriteCommand(&mc6846, val);
             
 	    if ((mc6846.crc&0x30) == 0x30)
-                to8_PutSoundByte(mc6809_clock(), mc6846.crc&8 ? 0 : (mc6821_ReadPort(&pia_ext.portb)&0x3F)<<2);
+                to8_PutSoundByte(mc6809_clock(), mc6846.crc&8 ? 0x80 : (mc6821_ReadPort(&pia_ext.portb)&0x3F)<<2);
             break; 
 
         case 0xE7C2:
@@ -291,7 +283,9 @@
         case 0xE7CD:
             mc6821_WriteData(&pia_ext.portb, val);
 
-	    if (!(mc6846.crc&8))  /* MUTE son inactif */
+            if (((pia_ext.portb.ddr&0x3F) != 0x3F) || (mc6846.crc&8))
+                to8_PutSoundByte(mc6809_clock(), 0x80);
+            else
                 to8_PutSoundByte(mc6809_clock(), (mc6821_ReadPort(&pia_ext.portb)&0x3F)<<2);
 
             break;
